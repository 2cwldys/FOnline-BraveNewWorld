                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      

import void InitLogs()from"logging";
import void FLog(uint logindex,string&text)from"logging";
import void ILog(string&section,string&text)from"logging";
import void GMLog(Critter&cr,string&text)from"logging";
import void CloseLogs()from"logging";
import uint AddLog(string&filename)from"logging";
import uint AddLog(string&filename,uint index)from"logging";
import void DynamicLocationAddLog(Critter&cr,Critter&npc,GameVar&var,string file)from"logging";
import void DynamicLocationDelLog(Critter&cr,Critter&npc,GameVar&var,string file)from"logging";                                    

import void SetQuestGarbager(uint time,uint playerid,uint locid,uint var,uint val)from"utils"; 

void map_init(Map&map,bool firstTime)
{
	map.SetEvent((7),"_OnLeaveMap");
	if(firstTime)
	SetQuestGarbager(3*60,0,map.GetLocation().Id,0,0);
}

void _OnLeaveMap(Map&map,Critter&cr)
{
	if((@cr.GetMap()!=null))
	return;
	
	Location@loc=map.GetLocation();
	if((@loc!=null))
	{
		DeleteLocation(loc.Id);
		FLog((23),"map_starter@_OnLeaveMap: locId "+loc.Id);
	}
	else
	Log("Invalid starter location.");
} 

bool s_Console(Critter&player,Scenery&console,int skill,Item@item)
{
	player.Say((11),"Access denied.");
	return true;
} 

void t_Tutorial(Critter&player,Scenery&trigger,bool entered,uint8 dir)
{
	Location@loc=player.GetMap().GetLocation();
	if(!(@loc!=null)||loc.GetProtoId()!=(2))
	{
		FLog((23),"ILLEGAL START LOCATION TRIGGER : map_starter@r_TutorialTeleport: locId "+((@loc!=null)?loc.Id:0)+" player id: "+player.Id);
		return;
	}
	
	if(entered&&(dir==3||dir==4))
	{
		player.Wait(0);
		RunDialog(player,23024,player.HexX,player.HexY,true);
	}
}  

void r_TutorialTeleport(Critter&player,Critter@npc)
{
	Location@loc=player.GetMap().GetLocation();
	if(!(@loc!=null)||loc.GetProtoId()!=(2))
	{
		FLog((23),"ILLEGAL NOOB CAMP TP : map_starter@r_TutorialTeleport: locId "+((@loc!=null)?loc.Id:0)+" player id: "+player.Id);
		return;
	} 
	
	Map@map=GetMapByPid(595,0);
	if(!(@map!=null))
	{
		Log("Teleport failed, tutorial map not found.");
		return;
	}
	player.TransitToMap(map.Id,0); 
	
	if((@loc!=null)&&loc.GetProtoId()==(2))
	{
		DeleteLocation(loc.Id);
		FLog((23),"map_starter@r_TutorialTeleport: locId "+loc.Id);
	}
	CreateTimeEvent(((__FullSecond)+(((3)*__TimeMultiplier))),"e_WelcomeMessage",player.Id,false);
} 

uint e_WelcomeMessage(array<int>@data)
{
	Critter@cr=GetCritter(data[0]);
	if((@cr!=null)&&cr.IsPlayer())
	{
		cr.Wait(0);
		RunDialog(cr,23007,cr.HexX,cr.HexY,true);
	}
	
	return(0);
}
